<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title>Home - Community Blog</title>
    <link th:href="@{/css/output.css}" rel="stylesheet">
    <script th:src="@{/js/tag-colors.js}" defer></script>
    <script th:src="@{/js/tag-overflow.js}" defer></script>
    <script th:src="@{/js/notification.js}" defer></script>
    <script th:src="@{/js/sidebar.js}" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-slate-50 to-indigo-50 min-h-screen">
<!-- Navigation -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <div class="bg-gradient-to-r from-indigo-600 to-purple-600 rounded-2xl p-8 mb-8 text-white shadow-xl animate-fade-in-up">
        <h1 class="text-3xl md:text-4xl font-bold mb-2">Welcome back, <span th:text="${user.fullName}">User</span>!</h1>
        <p class="text-indigo-100">Discover the latest stories from our community</p>
    </div>

    <!-- Posts List -->
    <div class="mb-8">
        <div class="flex items-center justify-between mb-6 animate-fade-in-up delay-100">
            <h2 class="text-2xl font-bold text-gray-800">
                <i class="fas fa-fire text-orange-500 mr-2"></i>Latest Posts
            </h2>
            <a th:href="@{/posts}"
               class="text-indigo-600 hover:text-indigo-700 font-semibold hover:underline transition-all">
                View All <i class="fas fa-arrow-right ml-1"></i>
            </a>
        </div>

        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div th:each="post, iterStat : ${posts}"
                 th:class="'bg-white rounded-2xl shadow-lg overflow-hidden hover-lift animate-fade-in-up delay-' + ${(iterStat.index + 2) * 100}">
                <div class="relative h-48 bg-gradient-to-br from-indigo-400 to-purple-500 overflow-hidden">
                    <img th:if="${post.thumbnailUrl}" th:src="@{${post.thumbnailUrl}}" alt="Post thumbnail"
                         class="w-full h-full object-cover">
                    <div th:unless="${post.thumbnailUrl}" class="w-full h-full flex items-center justify-center">
                        <i class="fas fa-image text-white text-6xl opacity-50"></i>
                    </div>
                    <div class="absolute top-4 right-4">
                            <span class="bg-white text-indigo-600 px-3 py-1 rounded-full text-sm font-semibold shadow-lg">
                                <i class="fas fa-tag mr-1"></i><span>Topic</span>
                            </span>
                    </div>
                </div>

                <div class="p-6">
                    <h3 class="text-xl font-bold text-gray-800 mb-3 hover:text-indigo-600 transition-colors line-clamp-1">
                        <a th:href="@{/posts/{id}(id=${post.id})}" th:text="${post.title}">Post Title</a>
                    </h3>

                    <p class="text-gray-600 mb-4 line-clamp-3" th:text="${post.plainContent}"></p>

                    <div class="relative flex flex-wrap items-center gap-2 tag-row max-w-full overflow-hidden mb-4">
                        <div class="absolute right-0 top-0 bottom-0 w-10 bg-gradient-to-l from-white pointer-events-none"></div>
                        <span th:each="tag : ${post.tags}"
                              class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium tag-pill bg-gray-100 text-gray-700 border border-gray-200 text-nowrap"
                              th:text="${tag}">
                        </span>
                    </div>

                    <div class="flex items-center justify-between pt-4 border-t border-gray-100">
                        <div class="flex items-center space-x-3">
                            <img th:src="@{${post.author.avatarUrl}}" alt="Author"
                                 class="w-10 h-10 rounded-full border-2 border-indigo-200">
                            <div>
                                <div class="font-semibold text-gray-800 text-sm" th:text="${post.author.fullName}">
                                    Author Name
                                </div>
                                <div class="text-xs text-gray-500" th:text="${post.timeAgo}">Date</div>
                            </div>
                        </div>

                        <div class="flex items-center space-x-4 text-sm text-gray-500">
                            <span class="flex items-center hover:text-indigo-600 transition-colors">
                                    <i class="fa-solid fa-eye mr-1"></i>
                                    <span th:text="${post.formattedViewCount}">0</span>
                                </span>
                            <span class="flex items-center hover:text-indigo-600 transition-colors">
                                    <i class="fas fa-heart mr-1"></i>
                                    <span th:text="${post.likeCount}">0</span>
                                </span>
                            <span class="flex items-center hover:text-indigo-600 transition-colors">
                                    <i class="fas fa-comment mr-1"></i>
                                    <span th:text="${post.commentCount}">0</span>
                                </span>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <div th:if="${#lists.isEmpty(posts)}" class="text-center py-16 animate-fade-in-up delay-200">
            <i class="fas fa-inbox text-gray-300 text-6xl mb-4"></i>
            <p class="text-gray-500 text-lg">No posts available yet</p>
            <a th:href="@{/posts/new}"
               class="inline-block mt-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white font-semibold px-6 py-3 rounded-xl hover:from-indigo-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-300 shadow-lg">
                <i class="fas fa-plus mr-2"></i>Create First Post
            </a>
        </div>
    </div>

    <div class="grid md:grid-cols-3 gap-6 animate-fade-in-up delay-400">
        <a th:href="@{/write-post}"
           class="bg-gradient-to-br from-indigo-500 to-purple-600 text-white p-6 rounded-2xl shadow-lg hover-lift group">
            <i class="fas fa-pen-fancy text-4xl mb-3 group-hover:scale-110 transition-transform"></i>
            <h3 class="text-xl font-bold mb-2">Write a Post</h3>
            <p class="text-indigo-100">Share your thoughts with the community</p>
        </a>

        <a th:href="@{/users/me}"
           class="bg-gradient-to-br from-purple-500 to-pink-600 text-white p-6 rounded-2xl shadow-lg hover-lift group">
            <i class="fas fa-user-circle text-4xl mb-3 group-hover:scale-110 transition-transform"></i>
            <h3 class="text-xl font-bold mb-2">My Profile</h3>
            <p class="text-purple-100">View and edit your profile</p>
        </a>

        <a th:href="@{/posts}"
           class="bg-gradient-to-br from-pink-500 to-red-600 text-white p-6 rounded-2xl shadow-lg hover-lift group">
            <i class="fas fa-compass text-4xl mb-3 group-hover:scale-110 transition-transform"></i>
            <h3 class="text-xl font-bold mb-2">Explore</h3>
            <p class="text-pink-100">Discover new content and writers</p>
        </a>
    </div>

</div>

<!-- Footer -->
<div th:replace="~{fragments/footer :: footer}"></div>
</body>
</html>