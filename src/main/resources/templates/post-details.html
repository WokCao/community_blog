<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <title th:text="${post.title} + ' - Community Blog'">Post Title - Community Blog</title>
    <link th:href="@{/css/output.css}" rel="stylesheet">
    <link th:href="@{/css/write-post.css}" rel="stylesheet">
    <meta property="og:title" th:content="${post.title}">
    <meta property="og:description" th:content="${post.content}">
    <meta property="og:url" th:content="@{'/post/' + ${post.id}}">
    <meta property="og:type" content="article">
    <script th:src="@{/js/tag-colors.js}" defer></script>
    <script th:src="@{/js/post-action.js}" defer></script>
    <script th:src="@{/js/comment-action.js}" defer></script>
    <script th:src="@{/js/notification.js}" defer></script>
    <script th:src="@{/js/follow.js}" defer></script>
    <script th:src="@{/js/sidebar.js}" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body class="bg-gray-50 min-h-screen">
<!-- Navigation -->
<div th:replace="~{fragments/navbar :: navbar}"></div>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
        <!-- Main Content -->
        <div class="lg:col-span-3">
            <!-- Post Header -->
            <article class="bg-white rounded-xl shadow-sm p-8 mb-8">
                <div class="mb-6">
                    <div class="flex items-center space-x-4 mb-4">
                        <img th:src="${post.author.avatarUrl}" th:alt="${post.author.fullName}" loading="lazy"
                             class="w-12 h-12 rounded-full object-cover">
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-900" th:text="${post.author.fullName}">Author Name</h3>
                            <p class="text-sm text-gray-500" th:text="${post.timeAgo}"></p>
                        </div>

                        <!-- Create a button to follow or unfollow the author -->
                        <button id="follow-btn" class="text-white px-4 py-1 rounded-full  transition hover:cursor-pointer" th:classappend="${post.author.id == user?.id ? 'hidden' : (isFollowing ? 'bg-gray-500 hover:bg-gray-600' : 'bg-blue-500 hover:bg-blue-600')}" th:data-user-id="${post.author.id}" th:data-action="${isFollowing ? 'unfollow' : 'follow'}">
                            <span th:text="${isFollowing ? 'Unfollow' : 'Follow'}"></span>
                        </button>

                        <span class="text-gray-500" th:utext="'The post will be publish at: <b>' + ${post.stringAutoPublishAt} + '</b>'" th:if="${post.autoPublishAt != null}"></span>
                    </div>

                    <h1 class="text-4xl font-bold text-gray-900 mb-4" th:text="${post.title}">Post Title</h1>

                    <div class="flex flex-wrap items-center gap-4 mb-6">
                        <div class="flex flex-wrap gap-2">
                                <span th:each="tag : ${post.tags}"
                                      class="px-3 py-1 rounded-full text-sm font-medium tag-pill"
                                      th:text="${tag}">Topic</span>
                        </div>
                        <div class="flex items-center space-x-4 text-sm text-gray-500">
                                <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                    </svg>
                                    <span th:text="${post.formattedViewCount}" class="mr-1"></span>
                                    <span>views</span>
                                </span>
                            <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
                                    </svg>
                                    <span th:text="${post.commentCount}" class="mr-1"></span>
                                    <span>comments</span>
                                </span>
                            <span class="flex items-center">
                                    <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                                    </svg>
                                    <span th:text="${post.saveCount}" class="mr-1"></span>
                                    <span>saved</span>
                                </span>
                        </div>
                    </div>

                    <!-- Social Actions -->
                    <div class="flex items-center justify-between border-t border-b border-gray-200 py-4">
                        <div class="flex items-center space-x-4">
                            <!-- Like/Dislike for authenticated users -->
                            <div class="flex items-center space-x-2">
                                <form class="like-post-form inline" th:data-post-id="${post.id}">
                                    <button type="submit"
                                            class="flex items-center space-x-1 px-4 py-2 rounded-lg transition hover:cursor-pointer"
                                            th:classappend="${isPostLikedByUser} ? 'bg-green-100 text-green-700' : 'bg-gray-100 text-gray-600 hover:bg-green-100 hover:text-green-700'">
                                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M7.493 18.75c-.425 0-.82-.236-.975-.632A7.48 7.48 0 016 15.375c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 012.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 00.322-1.672V3a.75.75 0 01.75-.75 2.25 2.25 0 012.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558-.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 01-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 00-1.423-.23h-.777zM2.331 10.977a11.969 11.969 0 00-.831 4.398 12 12 0 00.52 3.507c.26.85 1.084 1.368 1.973 1.368H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 01-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227z"/>
                                        </svg>
                                        <span th:id="'like-count-' + ${post.id}" th:text="${post.likeCount}"></span>
                                    </button>
                                </form>
                                <form class="dislike-post-form inline" th:data-post-id="${post.id}">
                                    <button type="submit"
                                            class="flex items-center space-x-1 px-4 py-2 rounded-lg transition hover:cursor-pointer"
                                            th:classappend="${isPostDislikedByUser} ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-600 hover:bg-red-100 hover:text-red-700'">
                                        <svg class="w-5 h-5 rotate-180" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M7.493 18.75c-.425 0-.82-.236-.975-.632A7.48 7.48 0 016 15.375c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 012.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 00.322-1.672V3a.75.75 0 01.75-.75 2.25 2.25 0 012.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558-.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 01-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 00-1.423-.23h-.777zM2.331 10.977a11.969 11.969 0 00-.831 4.398 12 12 0 00.52 3.507c.26.85 1.084 1.368 1.973 1.368H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 01-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227z"/>
                                        </svg>
                                        <span th:id="'dislike-count-' + ${post.id}"
                                              th:text="${post.dislikeCount}"></span>
                                    </button>
                                </form>
                                <a th:if="${user != null && user.id == post.author.id}" th:href="@{/posts/{id}/edit(id=${post.id})}" class="px-4 py-2 rounded-lg transition hover:cursor-pointer bg-gray-100 text-gray-600 hover:bg-blue-100 hover:text-blue-700">
                                    <i class="fa-solid fa-pencil"></i>
                                </a>
                            </div>
                        </div>

                        <!-- Share Button -->
                        <button onclick="shareOnFacebook()"
                                class="flex items-center space-x-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                            <span>Share on Facebook</span>
                        </button>
                    </div>
                </div>

                <!-- Post Content -->
                <div class="prose prose-lg max-w-none" th:utext="${post.content}">

                </div>
            </article>

            <!-- Comments Section -->
            <div th:if="${user != null && post.allowComment == true}"
                 class="bg-white rounded-xl shadow-sm p-8 mb-8">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Comments</h2>

                <!-- Add Comment Form -->
                <form class="add-comment-form mb-8" th:data-post-id="${post.id}">
                    <div class="flex space-x-4">
                        <img th:src="${user.avatarUrl}" th:alt="${user.fullName}" loading="lazy"
                             class="w-10 h-10 rounded-full object-cover flex-shrink-0">
                        <div class="flex-1">
                            <label>
                                <textarea name="content" rows="3" placeholder="Write a comment..."
                                          class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent resize-none"></textarea>
                            </label>
                            <div class="flex justify-end mt-3">
                                <button type="submit"
                                        class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-2 rounded-lg transition">
                                    Send
                                </button>
                            </div>
                        </div>
                    </div>
                </form>

                <!-- Comments List -->
                <div class="space-y-6">
                    <div th:each="commentView : ${comments}" class="flex space-x-4 comment-list">
                        <div class="m-0 p-0 w-full flex space-x-4">
                            <img th:src="${commentView.comment.commenter.avatarUrl}"
                                 th:alt="${commentView.comment.commenter.fullName}"
                                 loading="lazy"
                                 class="w-10 h-10 rounded-full object-cover flex-shrink-0">
                            <div class="flex-1">
                                <div class="rounded-lg"
                                     th:classappend="${commentView.comment.commenter.id == user.id} ? 'bg-gray-50 p-4' : 'px-4'">
                                    <div class="flex items-center space-x-2 mb-2">
                                        <h4 class="font-semibold text-gray-900"
                                            th:text="${commentView.comment.commenter.fullName}"></h4>
                                        <span class="text-sm text-gray-500"
                                              th:text="${commentView.comment.timeAgo}"></span>
                                    </div>
                                    <p class="text-gray-700" th:text="${commentView.comment.content}"></p>

                                    <div class="flex items-center justify-between pt-4">
                                        <div class="flex items-center space-x-1">
                                            <!-- Like Button -->
                                            <button type="submit"
                                                    th:disabled="${commentView.comment.commenter.id == user.id}"
                                                    th:data-comment-id="${commentView.comment.id}"
                                                    th:id="'like-cmt-btn-' + ${commentView.comment.id}"
                                                    class="like-cmt-btn group flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:cursor-pointer"
                                                    th:classappend="${commentView.liked} ? 'bg-emerald-50 text-emerald-700 hover:bg-emerald-100' : 'text-gray-500 hover:bg-emerald-100 hover:text-emerald-600'">
                                                <svg class="w-4 h-4 transition-transform group-hover:scale-110"
                                                     fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M7.493 18.75c-.425 0-.82-.236-.975-.632A7.48 7.48 0 016 15.375c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 012.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 00.322-1.672V3a.75.75 0 01.75-.75 2.25 2.25 0 012.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558-.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 01-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 00-1.423-.23h-.777zM2.331 10.977a11.969 11.969 0 00-.831 4.398 12 12 0 00.52 3.507c.26.85 1.084 1.368 1.973 1.368H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 01-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227z"/>
                                                </svg>
                                                <span th:id="'like-count-' + ${commentView.comment.id}"
                                                      th:text="${commentView.comment.likeCount}">0</span>
                                            </button>

                                            <!-- Dislike Button -->
                                            <button type="submit"
                                                    th:disabled="${commentView.comment.commenter.id == user.id}"
                                                    th:data-comment-id="${commentView.comment.id}"
                                                    th:id="'dislike-cmt-btn-' + ${commentView.comment.id}"
                                                    class="dislike-cmt-btn group flex items-center space-x-1 px-3 py-2 rounded-md text-sm font-medium transition-all duration-200 hover:cursor-pointer"
                                                    th:classappend="${commentView.disliked} ? 'bg-red-50 text-red-700 hover:bg-red-100' : 'text-gray-500 hover:bg-red-50 hover:text-red-600'">
                                                <svg class="w-4 h-4 rotate-180 transition-transform group-hover:scale-110"
                                                     fill="currentColor" viewBox="0 0 24 24">
                                                    <path d="M7.493 18.75c-.425 0-.82-.236-.975-.632A7.48 7.48 0 016 15.375c0-1.75.599-3.358 1.602-4.634.151-.192.373-.309.6-.397.473-.183.89-.514 1.212-.924a9.042 9.042 0 012.861-2.4c.723-.384 1.35-.956 1.653-1.715a4.498 4.498 0 00.322-1.672V3a.75.75 0 01.75-.75 2.25 2.25 0 012.25 2.25c0 1.152-.26 2.243-.723 3.218-.266.558-.107 1.282.725 1.282h3.126c1.026 0 1.945.694 2.054 1.715.045.422.068.85.068 1.285a11.95 11.95 0 01-2.649 7.521c-.388.482-.987.729-1.605.729H14.23c-.483 0-.964-.078-1.423-.23l-3.114-1.04a4.501 4.501 0 00-1.423-.23h-.777zM2.331 10.977a11.969 11.969 0 00-.831 4.398 12 12 0 00.52 3.507c.26.85 1.084 1.368 1.973 1.368H4.9c.445 0 .72-.498.523-.898a8.963 8.963 0 01-.924-3.977c0-1.708.476-3.305 1.302-4.666.245-.403-.028-.959-.5-.959H4.25c-.832 0-1.612.453-1.918 1.227z"/>
                                                </svg>
                                                <span th:id="'dislike-count-' + ${commentView.comment.id}"
                                                      th:text="${commentView.comment.dislikeCount}">0</span>
                                            </button>
                                        </div>

                                        <!-- Report Button -->
                                        <button onclick=""
                                                th:if="${commentView.comment.commenter.id != user.id}"
                                                th:data-comment-id="${commentView.comment.id}"
                                                class="group flex items-center space-x-1 px-3 py-1.5 rounded-md text-sm font-medium text-gray-500 hover:bg-orange-50 hover:text-orange-600 transition-all duration-200 hover:cursor-pointer">
                                            <svg class="w-4 h-4 transition-transform group-hover:scale-110" fill="none"
                                                 stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                      d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.35 16.5c-.77.833.192 2.5 1.732 2.5z"/>
                                            </svg>
                                            <span>Report</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Related Posts -->
            <div class="bg-white rounded-xl shadow-sm p-8 mb-8" th:if="${relatedPosts.size() > 0}">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">Related Posts</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <article th:each="relatedPost : ${relatedPosts}" class="group cursor-pointer">
                        <img th:src="${relatedPost.thumbnailUrl}" th:alt="${relatedPost.title}" loading="lazy"
                             class="w-full h-20 object-cover rounded-lg mb-4">
                        <a th:href="@{'/posts/' + ${relatedPost.id}}" class="block">
                            <h3 class="font-semibold text-gray-900 group-hover:text-indigo-600 transition mb-2"
                                th:text="${relatedPost.title}"></h3>
                            <p class="text-sm text-gray-600 mb-2 line-clamp-2"
                               th:text="${relatedPost.plainContent}"></p>
                            <div class="flex items-center text-sm text-gray-500">
                                <span th:text="${relatedPost.author.fullName}"></span>
                                <span class="mx-2">•</span>
                                <span th:text="${relatedPost.timeAgo}"></span>
                            </div>
                        </a>
                    </article>
                </div>
                <!-- Load More Button -->
                <div th:if="${totalRelatedPosts > 4}" class="text-center mt-8">
                    <a th:href="@{/posts}" class="bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-lg transition">
                        Load More Posts
                    </a>
                </div>
            </div>

            <!--             Author's Notable Posts -->
            <div class="bg-white rounded-xl shadow-sm p-8" th:if="${notablePosts.size() > 0}">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">More from <span
                        th:text="${post.author.fullName}"></span>
                </h2>
                <div class="space-y-4">
                    <article th:each="notablePost : ${notablePosts}" class="group">
                        <a th:href="@{'/posts/' + ${notablePost.id}}"
                           class="flex space-x-4 p-4 rounded-lg hover:bg-gray-50 transition">
                            <img th:src="${notablePost.thumbnailUrl}" th:alt="${notablePost.title}" loading="lazy"
                                 class="w-20 h-20 object-cover rounded-lg flex-shrink-0">
                            <div class="flex-1">
                                <h3 class="font-semibold text-gray-900 group-hover:text-indigo-600 transition mb-1"
                                    th:text="${notablePost.title}"></h3>
                                <p class="text-sm text-gray-600 mb-2 line-clamp-2"
                                   th:text="${notablePost.plainContent}"></p>
                                <div class="flex items-center space-x-4 text-sm text-gray-500">
                                    <span th:text="${notablePost.timeAgo}"></span>
                                    <span class="flex items-center space-x-2">
                                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor"
                                             viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                  stroke-width="2"
                                                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round"
                                                  stroke-width="2"
                                                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                        </svg>
                                        <span th:text="${notablePost.formattedViewCount}"></span>
                                        <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                                  d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                                        </svg>
                                        <span th:text="${notablePost.saveCount}"></span>
                                    </span>
                                </div>
                            </div>
                        </a>
                    </article>
                </div>
                <!-- Load More Button -->
                <div th:if="${totalNotablePosts > 4}" class="text-center mt-8">
                    <a th:href="@{/users/{id}/notable-posts(id=${post.author.id})}" class="bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-6 rounded-lg transition">
                        Load More Posts
                    </a>
                </div>
            </div>
        </div>

        <!-- Table of Contents Sidebar -->
        <div class="lg:col-span-1">
            <div class="sticky top-8">
                <div class="bg-white rounded-xl shadow-sm p-6">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4">Table of Contents</h3>
                    <nav id="table-of-contents" class="space-y-2">
                        <!-- Table of contents will be generated by JavaScript -->
                    </nav>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Footer -->
<div th:replace="~{fragments/footer :: footer}"></div>
<script>
    // Generate Table of Contents
    document.addEventListener('DOMContentLoaded', function () {
        const tocContainer = document.getElementById('table-of-contents');
        const headings = document.querySelectorAll('.prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6');

        if (headings.length === 0) {
            tocContainer.innerHTML = '<p class="text-sm text-gray-500">No headings found</p>';
            return;
        }

        headings.forEach((heading, index) => {
            // Add ID to heading for linking
            heading.id = `heading-${index}`;

            // Create TOC entry
            const tocItem = document.createElement('a');
            tocItem.href = `#heading-${index}`;
            tocItem.textContent = heading.textContent;
            tocItem.className = `block text-sm hover:text-indigo-600 transition py-1 ${getTocClass(heading.tagName)}`;

            tocContainer.appendChild(tocItem);
        });

        // Smooth scrolling
        document.querySelectorAll('#table-of-contents a').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({behavior: 'smooth', block: 'start'});
                }
            });
        });
    });

    function getTocClass(tagName) {
        switch (tagName.toLowerCase()) {
            case 'h1':
                return 'text-gray-900 font-semibold';
            case 'h2':
                return 'text-gray-800 font-medium pl-2';
            case 'h3':
                return 'text-gray-700 pl-4';
            case 'h4':
                return 'text-gray-600 pl-6';
            case 'h5':
                return 'text-gray-500 pl-8';
            case 'h6':
                return 'text-gray-400 pl-10';
            default:
                return 'text-gray-600';
        }
    }

    // Facebook Share Function
    function shareOnFacebook() {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}&t=${title}`;
        window.open(facebookUrl, 'facebook-share', 'width=580,height=296');
    }
</script>
</body>
</html>